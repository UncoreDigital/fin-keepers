---
import salesImage from "../../../assets/services/book-keeping/sales.png";
import salesImage_2 from "../../../assets/services/book-keeping/sales_2.png";
import whyImage from "../../../assets/services/book-keeping/why.png";
import whyImage_2 from "../../../assets/services/book-keeping/why_2.png";
import cashflowImage from "../../../assets/services/book-keeping/cashflow.png";
import cashflowImage_2 from "../../../assets/services/book-keeping/cashflow_2.png";
import oneImage from "../../../assets/services/book-keeping/1.png";
import oneImage_2 from "../../../assets/services/book-keeping/1_2.png";

const tabImages = {
  general: {
    default: salesImage,
    hover: salesImage_2,
    alt: "General Accounting",
  },
  payables: {
    default: whyImage,
    hover: whyImage_2,
    alt: "Account Payables and Receivables",
  },
  bank: {
    default: cashflowImage,
    hover: cashflowImage_2,
    alt: "Bank Reconciliation",
  },
  tax: {
    default: oneImage,
    hover: oneImage_2,
    alt: "Tax Ready Bookkeeping",
  }
};
---

<div class="main-container bg-[#f5f7fa] pt-16 pb-0 sm:py-16 px-4 sm:px-6 lg:px-20 mx-auto">
  <div
    class="max-w-screen-xl mx-auto flex flex-col gap-12 sm:gap-16 lg:gap-12 items-center animate-on-scroll opacity-0"
  >
    <!-- Heading -->
    <div
      class="flex flex-col gap-6 sm:gap-8 lg:gap-12 items-start text-left w-full animate-on-scroll-child opacity-0"
    >
      <h2
        class="text-2xl sm:text-3xl lg:text-4xl font-bold leading-tight text-[#04092a] font-['Inter']"
      >
        The Cash Flow Foundation Every Business Needs.
      </h2>
      <p
        class="text-base sm:text-lg leading-relaxed text-[#5c667a] font-['Inter']"
        style="max-width: calc(768px + 600px);"
      >
        We track incoming and outgoing funds with precision and ensure you always know your liquidity position. You get clear cash flow visibility that helps you plan confidently and avoid surprises.
      </p>
    </div>

    <!-- Tabs -->
    <div
      class="relative w-full overflow-hidden animate-on-scroll-child opacity-0"
    >
      <div
        id="tabsContainer"
        class="flex overflow-x-auto gap-3 px-4 py-4 sm:px-0 sm:py-6 scrollbar-hide scroll-smooth bg-white justify-start sm:justify-center max-w-full mx-auto snap-x snap-mandatory"
      >
        <button class="tab-button active-tab" data-tab="general"
          >Liquidity Management</button
        >
        <button class="tab-button" data-tab="payables"
          >Fraud Prevention Expertise</button
        >
        <button class="tab-button" data-tab="bank"
          >Payment - Payables and Receivables</button
        >
        <button class="tab-button" data-tab="tax">Financial Insights</button>
      </div>
    </div>

    <!-- Tab Content (dynamic area) -->
    <div
      id="tabContent"
      class="flex flex-col lg:flex-row gap-6 sm:gap-8 lg:gap-0 justify-center w-full max-w-screen-lg mx-auto animate-on-scroll-child opacity-0"
    >
      <!-- Left -->
      <div
        class="flex flex-col gap-4 sm:gap-6 p-3 sm:p-4 bg-white rounded-lg lg:rounded-r-none w-full lg:w-1/2 flex-grow"
      >
        <div class="flex flex-col gap-3 sm:gap-4 items-start">
          <img
            id="tabIcon"
            src="/img/services/SVG/c1.svg"
            alt="Tab Icon"
            class="w-9 h-9 sm:w-10 sm:h-10 shrink-0"
          />
          <h3
            id="tabTitle"
            class="text-xl sm:text-2xl font-semibold leading-tight text-[#151515]"
          >
            Liquidity Management
          </h3>
        </div>
        <p
          id="tabDescription"
          class="text-base sm:text-lg leading-relaxed text-[#797979]"
        >
          Small businesses might need a few cashflow management services, but
          managing liquidity is definitely one of them. Having enough liquidity
          for daily transactions is included in this subsection of Cashflow
          Management Services.
        </p>
      </div>

      <!-- Right -->
      <div
        class="flex justify-center items-center p-4 sm:p-6 bg-[#f5f7fa] rounded-lg lg:rounded-l-none w-full lg:w-1/2 flex-grow group"
      >
        <div
          class="relative w-full max-w-[280px] aspect-square overflow-hidden"
        >
          <!-- Default Image -->
          <img
            id="tabImageDefault"
            src={salesImage.src}
            alt="General Accounting"
            class="absolute inset-0 w-full h-full object-contain object-center transition-opacity duration-700 ease-in-out opacity-100 group-hover:opacity-0"
          />
          <img
            id="tabImageHover"
            src={salesImage_2.src}
            alt="Business Woman with tablet and growth charts - Hover"
            class="absolute inset-0 w-full h-full object-contain object-center transition-opacity duration-700 ease-in-out opacity-0 group-hover:opacity-100"
          />
        </div>
      </div>
    </div>
  </div>
</div>

<style>
  /* Tab button styling */
  .tab-button {
    flex-shrink: 0;
    padding: 0.5rem 1rem;
    border-radius: 6px;
    font-size: 0.9rem;
    font-weight: 500;
    color: #797979;
    border: 1px solid #ccc;
    white-space: nowrap;
    transition: all 0.3s;
  }
  .tab-button.active-tab {
    background: #ed7c00;
    color: #fff;
    font-weight: 600;
    border: none;
  }

  @keyframes fade-up {
    from {
      opacity: 0;
      transform: translateY(30px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
  .animate-fade-up {
    animation: fade-up 0.8s ease-out forwards;
  }
</style>

<script define:vars={{ tabImages }}>
  // Tabs data
  const tabContentData = {
    general: {
      title: "Liquidity Management",
      description:
        "Small businesses might need a few cashflow management services, but managing liquidity is definitely one of them. Having enough liquidity for daily transactions is included in this subsection of Cashflow Management Services. ",
      icon: "/img/services/SVG/c1.svg",
      images: tabImages.general,
    },
    payables: {
      title: "Fraud Prevention Expertise",
      description:
        "This is for businesses that deal with daily cash incoming and outgoing, like financial institutions, banks, etc. To prevent fraud from happening, online or offline, it is essential to opt for this service.",
      icon: "/img/services/SVG/c2.svg",
      images: tabImages.payables,
    },
    bank: {
      title: "Payment - Payables and Receivables",
      description:
        "Some businesses consist of cash payables and receivables, like institutions that lend money on loan. Hence, what amount is to be paid or received needs to be calculated with utmost precision.",
      icon: "/img/services/SVG/c3.svg",
      images: tabImages.bank,
    },
    tax: {
      title: "Financial Insights",
      description:
        "This is to provide better insight about market conditions, competitors, what has been done up until now, and how the future can be improved. This part of cashflow management includes financial reporting an financial modelling, which requires the skills, experience, and understanding that Finkeepers bring to the table.",
      icon: "/img/services/SVG/c4.svg",
      images: tabImages.tax,
    },
  };

  // DOM references
  const tabButtons = document.querySelectorAll(".tab-button");
  const tabTitle = document.getElementById("tabTitle");
  const tabDescription = document.getElementById("tabDescription");
  const tabIcon = document.getElementById("tabIcon");
  const tabImage = document.getElementById("tabImage");

  // Switch tab
  function switchTab(tabKey, button) {
    // update buttons
    tabButtons.forEach((btn) => btn.classList.remove("active-tab"));
    button.classList.add("active-tab");

    // update content
    const content = tabContentData[tabKey];
    if (content) {
      tabTitle.textContent = content.title;
      tabDescription.textContent = content.description;
      tabIcon.src = content.icon;
      
       // Update dynamic images
      if (content.images) {
        tabImageDefault.src = content.images.default.src;
        tabImageDefault.alt = content.images.alt;
        tabImageHover.src = content.images.hover.src;
        tabImageHover.alt = content.images.alt;
      }
    }
  }

  // Init
  tabButtons.forEach((button) => {
    button.addEventListener("click", () => {
      const key = button.getAttribute("data-tab");
      if (key) switchTab(key, button);
    });
  });

  // Default first tab
  document.addEventListener("DOMContentLoaded", () => {
    const first = tabButtons[0];
    if (first) {
      const key = first.getAttribute("data-tab");
      switchTab(key, first);
    }
  });

  // Scroll animation observer
  const observer = new IntersectionObserver(
    (entries) => {
      entries.forEach((entry) => {
        if (entry.isIntersecting) {
          entry.target.classList.add("animate-fade-up");
          entry.target.classList.remove("opacity-0");
          observer.unobserve(entry.target);
        }
      });
    },
    { threshold: 0.2 },
  );

  document
    .querySelectorAll(".animate-on-scroll, .animate-on-scroll-child")
    .forEach((el) => observer.observe(el));
</script>
